
# 第五章 线性系统的频域分析法

[toc]

## 1 基本概念

!!! note "对比分析"
    时域法：**直接分析闭环极点**，判断闭环系统的输出（实际上是铺垫，因为讲时域分析方法的时候，只是针对一阶二阶这样的模块，没有强调反馈的存在）
    根轨迹法：通过开环传递函数的零极点，以根轨迹**求解**得到**闭环零极点**, 分析闭环性能
    频域法：从开环传递函数的**频率特性**（三频段理论只适用于**单位负反馈的最小相角系统**) 直接分析闭环特征
    **TODO: 也许这个可以单独开一页**

频率特性：**稳态正弦响应**的幅相变化

- 幅值比，相角差
- 输出的富氏变换/输入的富氏变换
- $G(s)\to G(j\omega)$[^1].
- 在 `[s]` 平面上，自变量沿虚轴取值 $s=j0\to j\infty$ 时，复函数 $G(s)$ 在 `[G]` 平面上用复矢量描述，即频率特性 [^2].
    ![](assets/%E7%AC%AC05%E7%AB%A0%20%E7%BA%BF%E6%80%A7%E7%B3%BB%E7%BB%9F%E7%9A%84%E9%A2%91%E5%9F%9F%E5%88%86%E6%9E%90%E6%B3%95/2022-03-08-18-54-23.jpg)
    - s 平面：自变量沿虚轴取值，画出 $G(s)$ 各个零极点指向自变量的矢量，能够很直观地获得每个零极点贡献的幅值和相角.
    - G 平面：实质上就是奈氏曲线

[^1]: 关于为什么直接把 s 替换成 $j\omega$ 就可以... 似乎有证明的. 总之，频率特性可由传递函数直接获得.
[^2]: s 平面，G 平面是卢京潮老师讲课时经常使用的分析方法. 但是我觉得，不依靠这 s 平面也能进行分析，就单纯地把传递函数化成零极点式，然后逐个当作复数分析角度即可（幅值都是从 1 到无穷）.

各种曲线：

- 频率特性曲线 (?)
    - 相频特性曲线 $L(\omega)$
    - 幅频特性曲线 $\varphi(\omega)$
- 幅相特性曲线 $G(j\omega)$  (Nyquist 曲线）`[G]` 平面
- 对数频率特性 （波特图）
    - 对数幅频特性
    - 对数相频特性
- 对数幅相特性曲线 （尼克尔斯图 Nichols）: 闭环频率特性曲线绘制的时候用到了

!!! attention
    注意频域分析中 角频率$\omega$ 的单位是 $rad/s$
    $\omega=2\pi f$
    而相角裕度往往用 ° 作为单位
    谨慎区分

## 2 Nyquist 曲线 - 辐相频率特性曲线

又称：开环幅相曲线

### 2.1 一些典型曲线的研究

- 比例环节
- 积分环节：分母 s
- 惯性环节：分母一阶
    - 不稳定惯性环节
- 二阶震荡环节：分母二阶
    - 不稳定二阶震荡环节
- 一阶复合微分环节：分子一阶
    - 不稳定的一阶复合微分环节
- 二阶复合微分环节：分子二阶
    - 不稳定的二阶复合微分环节
- 延迟环节

#### 2.1.1 二阶震荡环节的奈氏曲线与谐振现象 <a id="two"></a>

![](assets/%E7%AC%AC05%E7%AB%A0%20%E7%BA%BF%E6%80%A7%E7%B3%BB%E7%BB%9F%E7%9A%84%E9%A2%91%E5%9F%9F%E5%88%86%E6%9E%90%E6%B3%95/2022-03-08-19-40-16.png)

谐振频率、谐振峰值
谐振峰值$M_r$—振荡环节稳态输出能达到的最大幅值比
谐振频率$\omega_r$—使输出达到幅值时的频率值

![](assets/%E7%AC%AC05%E7%AB%A0%20%E7%BA%BF%E6%80%A7%E7%B3%BB%E7%BB%9F%E7%9A%84%E9%A2%91%E5%9F%9F%E5%88%86%E6%9E%90%E6%B3%95/2022-03-08-19-45-18.png)
> s 平面分析：固定$\omega_n$, 这样极点都位于圆弧上. 不同的 $\xi$ 画出对应的频率特性.
> 第二张图画了一张竖线，但是谐振频率实际上并不是固定的，$\xi=0.707$时刚开始出现共振$\omega_r=0$, 随着阻尼比减小，$\omega_r\uparrow$, 最终 $\omega_r=\omega_n$, 谐振峰值也变为无穷大.

简单记忆：阻尼比越小，曲线越陡峭.

奈氏曲线的特殊点：**与虚轴交点** $-j\frac{1}{2\xi}$, 此时$\omega=\omega_n$.

#### 2.1.2 延迟环节

![](assets/%E7%AC%AC05%E7%AB%A0%20%E7%BA%BF%E6%80%A7%E7%B3%BB%E7%BB%9F%E7%9A%84%E9%A2%91%E5%9F%9F%E5%88%86%E6%9E%90%E6%B3%95/2022-03-08-19-55-39.png)
在时域上，延迟环节表现为信号的平移.
在频域上，延迟环节减小相角 $\tau\omega$, 即频率越高相角减少越小. 含有延迟环节的奈氏曲线就变成了一种螺旋型.

> 螺旋形意味着转多少圈不确定，分析稳定性时可以分析下特殊点，例如计算延迟为多少时，奈氏曲线刚好过$(-1,0)$

### 2.2 Nyquist 曲线的绘制

1. 确定$G(j0)$,$G(j\infty)$
2. 中间段由变化规律大概绘制
3. 必要时计算与实轴，虚轴的交点

奈氏曲线只能画一个大概，例如：

- 中间段变化趋势只能认为是**单调变化**的，大多数情况下**判稳**足够了.
- 起始的无穷远点一般是贴着虚轴画，实际上无穷远点可能与虚轴有一段距离

有些特殊情况下会画的不太准确（尤其是具有非最小相位环节）, 详见 [修正部分](#修正).

### 2.3 Nyquist 曲线的修正 <a id="修正"></a>

曲线指定了 $\omega=0\to \infty$ （结合后面稳定判据，实际上是 Nyquist 路径的一半。)

1. 虚轴上存在极点
    1. 如果有积分环节 （原点处有极点），则需要绕一个路径，从$0\;(s=\varepsilon+j0)\to 0^+ (s=0+j\varepsilon)$. 反映在 Nyquist 曲线上就是多了一个虚线圆弧. **相角突变减少 90°**
    2. 如果在虚轴上有其他共轭极点，也是同理进行补充。 **相角突变减少 180°**
    3. 总结：对于极点$j\omega$, 取路径$j\omega+\epsilon e^{j\theta}$, 按照逆时针路径（相角增大的方向走）. 因为极点是在分母上作用，所以这段路径使幅值无限大，相角往减小的方向走（逆时针）.

        模都是无穷大，相角有个跳跃.

2. $\omega=0^+$ 时刻，**离虚轴最近的那个零点或者极点**对相角变化产生的影响**最先发挥作用，**故需要使角度进行一定程度的修正，比如 $90^{\circ}\to90^{\circ}-$
3. 存在不稳定环节 $\tau s-1,\frac1{Ts-1}$时， 系统为非最小相位系统，相角变化往往变得更大。分析方法同 2。

    $\omega=0^+$ 时刻，**离虚轴最近的那个零点或者极点**对相角变化产生的影响**占主导地位。**因此相角变化可能会有个折返 ，例如先增大（非线性的$\frac1{Ts-1}$刚开始让相角增大）后减小（总体趋势不可违背）（一般情况下， 普通的相角则是默认单调变化的）

    ![](assets/经典控制理论/Untitled%209.png)

一般我们画奈氏曲线，实际上是概略曲线，认为**相角单调减小**，而存在零点甚至不稳定环节时，曲线可能会扭曲，这种相角折返是分析不出来的.
所以，如果需要的话，需要通过 $G(j\omega)$分析一下和对应的轴有没有交点.
和实轴交点：$G(j\omega)$ 虚部为 0 求解 $\omega$; 另一种情况同理.

## 3 波特图 - 幅频特性曲线

- 横轴：$\lg \omega$ 为单位长度，**等距等比**
- 纵轴：$L(\omega)=20\lg |G(\omega)| dB$

!!! tip "关于单位分贝"
    单位：贝尔，分贝 最初是用来衡量声音强度
    声源**功率**提升 10 倍，人耳听起提升大 1 倍
    $\lg\frac{p_c}{p_r}(B)=10\lg\frac{p_c}{p_r}(dB)$
    > 1 贝尔=10 分贝
    > $p_r$ 指人耳刚好听到声音

    由于在电学中，$p=\frac{u^2}{R}$, 因此用 u 衡量功率，多了个平方，1 B = 20 dB
    > 波特图中幅值也就是电压幅值

波特图的特点：
![](assets/%E7%AC%AC05%E7%AB%A0%20%E7%BA%BF%E6%80%A7%E7%B3%BB%E7%BB%9F%E7%9A%84%E9%A2%91%E5%9F%9F%E5%88%86%E6%9E%90%E6%B3%95/2022-03-08-21-00-32.png)

!!! tip "关于横轴坐标"
    在画幅频特性曲线时，横坐标是以 $\lg \omega$ 为单位的，等距等比.
    所以纵轴不可能放在 $\omega=0$ 处. 一般来说，**纵轴起始位置**的 $\omega$ 是 0.1, 1, 0.01 这种.
    因此，尽管零型以上的系统，$\omega\to0$ 时，幅值为无穷大，但是波特图上不会出现无穷大的点.
    另外，在用波特图进行相关计算时，根据等距等比可以列关系式（差不多是用几何关系求）

几个关键频率：
![](assets/%E7%AC%AC05%E7%AB%A0%20%E7%BA%BF%E6%80%A7%E7%B3%BB%E7%BB%9F%E7%9A%84%E9%A2%91%E5%9F%9F%E5%88%86%E6%9E%90%E6%B3%95/2022-03-08-21-29-27.png)

### 3.1 二阶系统波特图分析

其实 [前文](#two) 已经很好地分析了二阶震荡环节的谐振现象.
这里特别拿出幅频特性分析对数幅频曲线的特点。
![](assets/%E7%AC%AC05%E7%AB%A0%20%E7%BA%BF%E6%80%A7%E7%B3%BB%E7%BB%9F%E7%9A%84%E9%A2%91%E5%9F%9F%E5%88%86%E6%9E%90%E6%B3%95/20220308210819.jpg)
> 注意这里是对数幅频曲线，谐振处高度为 $20\lg M_r$

阻尼比越小，曲线越陡峭，$\xi=0$ 时：
![](assets/%E7%AC%AC05%E7%AB%A0%20%E7%BA%BF%E6%80%A7%E7%B3%BB%E7%BB%9F%E7%9A%84%E9%A2%91%E5%9F%9F%E5%88%86%E6%9E%90%E6%B3%95/2022-03-08-21-25-02.png)

> 二阶复合微分环节和震荡环节只是一个在分子一个在分母
> 取对数之后是正负符号相反，因此计算公式基本相同（谐振峰值计算公式分母放分子上，或者取对数后取反）.

### 3.2 由传递函数绘制波特图

- 分母有几个 s （积分环节） --> **确定初始斜率**
- 开环增益 K （舍去积分环节 $s^v$ 后令 $s=0$) --> **确定关键点**
    - 关键点 1: $\omega=1, L(1)=20\lg K$
    - 关键点 2: 低频段延长线交横轴交点 $L=0dB, \omega=K^{\frac1v}$
        > $A=\frac{K}{s^v}=1\to\omega=K^{\frac1v}$
- 经过上两步，低频段能够完全确定，之后就是依次经过转折频率，斜率相应变化
    > 大多情况下，波特图是绘制个大概趋势，如果是精确绘制的话，用半对数坐标纸画就好了.
- 最后矫正二阶环节
    ![](assets/%E7%AC%AC05%E7%AB%A0%20%E7%BA%BF%E6%80%A7%E7%B3%BB%E7%BB%9F%E7%9A%84%E9%A2%91%E5%9F%9F%E5%88%86%E6%9E%90%E6%B3%95/2022-03-08-21-43-34.png)

> 当然如果不熟练的话，对传递函数进行转换，$G(s)=\frac{K(\frac{s}{\omega_2}+1)}{s(\frac{s}{\omega_1}+1)(\frac{s}{\omega_3}+1)}$

关于对数相频曲线：
![](assets/%E7%AC%AC05%E7%AB%A0%20%E7%BA%BF%E6%80%A7%E7%B3%BB%E7%BB%9F%E7%9A%84%E9%A2%91%E5%9F%9F%E5%88%86%E6%9E%90%E6%B3%95/2022-03-08-21-47-52.png)
对数相频曲线一般只能通过特殊点描了。

### 3.3 波特图相关计算

!!! abstract
    根据波特图进行计算时，往往有两个思路：几何上用等距等比列式求解某个坐标；或者用"近似的传递函数"计算，这感觉更好用更接近本质，但是课本上好像并没有明确的表述.

由波特图确定传递函数
![](assets/%E7%AC%AC05%E7%AB%A0%20%E7%BA%BF%E6%80%A7%E7%B3%BB%E7%BB%9F%E7%9A%84%E9%A2%91%E5%9F%9F%E5%88%86%E6%9E%90%E6%B3%95/2022-03-08-21-47-19.png)

由波特图确定某个转折频率，增益
![](assets/%E7%AC%AC05%E7%AB%A0%20%E7%BA%BF%E6%80%A7%E7%B3%BB%E7%BB%9F%E7%9A%84%E9%A2%91%E5%9F%9F%E5%88%86%E6%9E%90%E6%B3%95/2022-03-08-22-04-41.png)

由波特图**确定截止频率** <a id="确定截止频率"></a>
波特图本身就是**近似**的，近似规则体现如下：
由于系统的基本单位是 $\frac s\omega+1,\;\frac 1{\omega^2}s^2+2\frac\xi\omega s+1$
转折频率在 $\omega_c$ 后面的，没有发挥作用，求模的过程中置为 1
转折频率在 $\omega_c$ 前面的，发挥了作用，求模的过程中置为$\frac s\omega,\;(\frac s\omega)^2$

如果没有精确的波特图让你读数，要手算幅频特性曲线上的$\omega_c$, 就通过上面这个规则进行...

- 你需要先判断下截止频率在哪个区间，如果题目只给了开环传函，也可以先根据转折频率**画出幅频曲线的大致趋势**，然后依次判断转折频率处模大于 1 还是小于 1，从而**确定截止频率所处区间**
- 然后传递函数进行相应的转换，转折频率<截止频率，则该环节置为 $\frac s\omega,\;(\frac s\omega)^2$; 转折频率>截止频率，则该环节置为 1.
- 最后令简化后的"传递函数"模为 1, 算出截止频率.

    > 最后这个算的步骤可以通过计算器进行试根~

### 3.4 由波特图进行频域分析的基本观念：**斜率与角度对应**

!!! cite
    本思路在卢京潮老师的课程中有详细介绍，强烈建议掌握.

|斜率|对应相角|
| --- | --- |
| 20dB/dec | 90° |
| 0dB/dec | 0° |
| -20dB/dec | -90° |
| -40dB/dec | -180° |
| -60dB/dec | -270° |

众所周知，传递函数可以拆分成 由 s 和 $\frac s\omega+1$ 作为基本单位组成的，区别只是放在分子还是分母，以及转折频率不同.

- 对于 积分环节 $\frac{1}{s}$ 和微分环节 $s$，提供的相角是稳定不变的
- 而对于$s+\omega$ , 当 s 较大时，相角趋向 90°，也视为稳定不变的，相角的归宿为此.

因此，对于每个特定的斜率，相角都有一个最终的归宿，如果 L 的斜率一直保持在斜率 k , 则相角将**趋向并稳定**在相应的角度 $\frac{k}{20}*90$.

根据 L 的斜率变化，我们可以知道相角的变化趋势，是在何时有向上趋势，何时有向下趋势.

**基于上述理解，可以获得下面的结论：**

- 如果 k 依次是 -20, -40, -60, 对应 -90, -180, -270. 其中最左边最右边都是平的，左右施加影响力相同，那么根据对称性，很容易理解 $\varphi(\omega_g)=180^\circ$ 处于两个转折频率几何中心处.
  ![](assets/%E7%AC%AC05%E7%AB%A0%20%E7%BA%BF%E6%80%A7%E7%B3%BB%E7%BB%9F%E7%9A%84%E9%A2%91%E5%9F%9F%E5%88%86%E6%9E%90%E6%B3%95/2022-03-09-16-31-10.png)
- 如果幅频特性左右平移，那么相频特性也将同步平移.
- -20 对应-90, 因此我们希望中频带以-20 斜率穿越 0dB 线，并且中频带尽可能宽. （如果中频带无限宽，那么相角裕度将无限趋于 $\gamma=180-90=90$ )
- 从感性角度理解，每个斜率都是一个领域，在这个领域内，相频特性曲线将向着斜率对应的最终归宿去努力.

    只不过领域受左右领域的影响。如果本领域足够宽，那么将屏蔽掉左右的影响.

    滞后超前矫正，我们让滞后部分规定幅值，但是不希望影响相角，那么就让超前部分起作用的点与滞后部分转折频率 $\frac 1{bT}$ 相差 10 倍，这样滞后部分施加的影响就是-6°, 如此就可以安心只考虑超前部分设计了.

## 4 系统稳定性的频域分析法

### 4.1 稳定性 —— 奈式判据

> 仅针对最小相位系统，$\gamma >0, h>1$ 时系统一定稳定. 其他情况要用奈氏判据.

#### 4.1.1 基本方法

$Z=P-2N$

- Z: 右半 s 平面闭环极点个数 （如果 $Z>0$ 则系统不稳定，Z 不可能为负）
- P: 右半 s 平面开环极点个数
- N: 有很多种理解方式，不同的理解方式对应不同的**奈氏判据**
    - 用**最初推导结论**的理解方式：N 是奈氏曲线 $G(j\omega)$ 逆时针绕 $(-1, j0)$ 的**圈数**.
        逆时针方向为正圈数，顺时针方向为负圈数
        ![](./assets/%E7%AC%AC05%E7%AB%A0%20%E7%BA%BF%E6%80%A7%E7%B3%BB%E7%BB%9F%E7%9A%84%E9%A2%91%E5%9F%9F%E5%88%86%E6%9E%90%E6%B3%95/20220309_164418.jpg)

    - 更简洁实用的理解方式：看奈氏曲线，N 是 -1 左侧的**净穿越次数**，不记录穿过 $(-1,j0)$ 的次数，穿过时临界稳定.
        从下往上穿越，相角减小，是一次负穿越 $N_-$；从上往下穿越，相角增大，是一次正穿越 $N_+$ ；
        如果穿越起点来自实轴，则是半次穿越.
        最后 $N=N_+-N_-$
    - 此外，从波特图的对数相频特性曲线也能够看，看 -180° ($(2k+1)\pi$) 线的**穿越次数**. 此方法也叫做对数稳定判据.
        相角减小，是一次负穿越；相角增大，是一次正穿越；

!!! note "关于原始推导"
    [奈奎斯特稳定性判据_Nyquist Stability Criterion 哔哩哔哩](https://www.bilibili.com/video/BV1yg4y1B7JM)
    讲的挺好的，用到了柯西辐角原理 / 围线映射

#### 4.1.2 应用举例

这里列举了一些特殊情况，处理方法回顾 [奈氏曲线的修正](#修正).

??? example "具有不稳定环节系统的奈氏曲线与判稳"
    ![](assets/%E7%AC%AC05%E7%AB%A0%20%E7%BA%BF%E6%80%A7%E7%B3%BB%E7%BB%9F%E7%9A%84%E9%A2%91%E5%9F%9F%E5%88%86%E6%9E%90%E6%B3%95/2022-03-09-17-07-08.png)

??? example "虚轴上存在极点的奈氏曲线与判稳"
    ![](assets/%E7%AC%AC05%E7%AB%A0%20%E7%BA%BF%E6%80%A7%E7%B3%BB%E7%BB%9F%E7%9A%84%E9%A2%91%E5%9F%9F%E5%88%86%E6%9E%90%E6%B3%95/2022-03-09-17-24-12.png)
    ![](assets/%E7%AC%AC05%E7%AB%A0%20%E7%BA%BF%E6%80%A7%E7%B3%BB%E7%BB%9F%E7%9A%84%E9%A2%91%E5%9F%9F%E5%88%86%E6%9E%90%E6%B3%95/2022-03-09-17-22-48.png)

#### 4.1.3 特点

- 由**开环幅相**曲线判断**闭环系统稳定性**
- 便于研究当系统结构参数改变时对系统稳定性的影响
- 容易研究包含**延迟环节**的系统的稳定性
- 推广之，可用以分析某些非线性系统的稳定性

    > 可以研究包含延迟环节系统的稳定性

### 4.2 稳定程度 —— 稳定裕度

在稳定的基础上，判断稳定的程度，就是稳定裕度
![](assets/%E7%AC%AC05%E7%AB%A0%20%E7%BA%BF%E6%80%A7%E7%B3%BB%E7%BB%9F%E7%9A%84%E9%A2%91%E5%9F%9F%E5%88%86%E6%9E%90%E6%B3%95/2022-03-09-17-27-45.png)

#### 4.2.1 概念

两个频率：

- 截止频率 $\omega_c$: $|G(j\omega_c)|=1$, $L(\omega_c)=0$
- 相角交界频率 $\omega_g$: $\varphi(\omega_g)=-180^\circ$

两个裕量：

- 幅值裕量（相角 180 时）:
    - $h=\frac{1}{|G_0(j\omega_g)|}$
    - 单位时 dB 时，幅值裕度$h(dB)=20lg\frac 1{|G(j\omega_g)|}=-20lg|G(j\omega_g)|$
- 相角裕量（幅值 1 时）: $\gamma=180^\circ+\theta(\omega_c)$

> 注：卢京潮讲的 相角 180 时，对应的是 $\omega_g$, 而当时老师讲的是 $\omega_x$

稳定裕度的物理意义：

- $\gamma$ 系统在**相角**方面的稳定储备量，系统串联延时环节 $e^{-\tau s}$，消耗相角储备
- $h$ 系统在**幅值**方面的稳定储备量，系统串联比例放大环节，消耗幅值储备

一个性能良好的控制系统，其：

- 相位裕度应具有 45° 左右 ($30\sim60$ ) 的数值。
- 幅值裕度 $h>6dB$ , $h>2$ （单位不同）

    > `20*math.log(2,10) --> 6.020599913279623`

!!! note
    - 结构稳定
    - 条件稳定：参数影响稳定性 ⇒ 需要提出 $\gamma,h$ 衡量相对稳定性
    - 结构不稳定

    第二条忘记理由是啥了 ... 大概可以这样理解：结构稳定的系统，你怎么造都稳定；而有的系统你调整参数后可能就不稳定了，稳定裕量就是给你调整参数提供一定程度的自由.

#### 4.2.2 频域指标和时域动态性能指标

$\gamma, h \leftrightarrow \sigma\%, t_s$

- 一二阶典型系统：有现成的公式，但是没必要记，自己算很容易.
- 高阶系统：**经验估计公式 [胡寿松 P218]**
    - $\sigma\%=0.16+0.4(M_r-1)\times 100\%$
    - $t_s=\frac\pi {\omega_c}[2+1.5(M_r-1)+2.5(M_r-1)^2]$

!!! note "关于 $M_r$"
    $M_r$ 实际上是闭环的谐振峰值，（我根据听卢京潮老师的课以及对比开环闭环估计性能的公式得到的结论，课本上没有这么说过）, 如果用谐振峰值代入，就是闭环的近似计算公式.
    $M_r=M(\omega_r)\approx\frac{1}{\sin\gamma}$ 用相角裕度计算，就是开环的近似估计公式.

    近似公式的使用条件：$1\le M_r\le1.8,\quad 35^\circ\le \gamma\le 90^\circ$ 

!!! note "二阶系统阻尼系数与相角裕度"
    $\xi \approx 0.01 \gamma$
    ![](assets/%E7%AC%AC05%E7%AB%A0%20%E7%BA%BF%E6%80%A7%E7%B3%BB%E7%BB%9F%E7%9A%84%E9%A2%91%E5%9F%9F%E5%88%86%E6%9E%90%E6%B3%95/2022-03-10-12-16-39.png)
    ![](assets/%E7%AC%AC05%E7%AB%A0%20%E7%BA%BF%E6%80%A7%E7%B3%BB%E7%BB%9F%E7%9A%84%E9%A2%91%E5%9F%9F%E5%88%86%E6%9E%90%E6%B3%95/2022-03-10-12-16-53.png)
    [自动控制里面，系统的相位裕度（PM）一定与阻尼比成正比吗？ - Smutkgg 的回答 - 知乎](https://www.zhihu.com/question/56007538/answer/147558663)

低阶系统时域法更加简单；（频域的计算并不比时域的计算简单）
高阶系统频域法更简单。（时域要找主导极点，零点极点法）

实际上，系统阶数比较低时，知道一个参数通过查各种图表就能够知道其他参数，这在工程上意义比较大，这里就不赘述了. 手算也能很快算出来。

#### 4.2.3 求稳定裕度的思路总结

- 相角裕度 $\gamma$ 的基本方法
    - **精确解法**: 根据$|G(j\omega_c)|=1$求解高阶 $\omega$ 方程组 （计算器试根之类的）
    - **近似解法**: 根据波特图 $L(\omega)-\omega$ ，找到幅值特性曲线与水平轴的交点$\omega_c$ 即为截止频率

        > 限于篇幅，详见"波特图相关计算"中的 [确定截止频率](#确定截止频率)

    - **实际操作解法**: 一般不会计算精确的截止频率，而是基于波特图计算.
        - 如果波特图已知，那么可以根据一定的几何关系列式求出截止频率，比如说等距等比，这个技巧性更高一些.
        - 另外，保底的方法是，$\omega_c$ 代入$G(j\omega)$，把没有发挥作用的屏蔽掉，从而得到一个近似的截止频率. （用上面近似解法的思路）

- 幅值裕度 $h$ 的基本方法

    由于相频特性曲线不好画，因此$\omega_g$最好还是代数**精确求解**。

    - 方法一：根据相角条件，解三角方程 $\theta_1+\theta_2+\theta_3=\cdots$
        - $\arctan A+\arctan B=\arctan [\frac{A+B}{1-AB}]$

            如果不太能理解的话，先把 2 个角度放一边，然后两边取 tan，是一样的

            ![](assets/经典控制理论/Untitled%208.png)

        - 化简之后呢，就是一个$\arctan \varphi(\omega)=\theta$ 一般来说都是 0°或者 90°

            0°说明分子是 0，90°说明分母是 0; 如果是一般的度数的话，只能用计算器计算反三角函数了.

    - 方法二：整理$G(j\omega)=X+jY$，令$Y=0$ 解出来

## 5 三频段理论

三频段理论**分析对象是幅频特性曲线**, 只适用于**单位反馈的最小相位系统**

- 三频段理论针对 $L(\omega)$
- **只有最小相位系统**才能够仅由幅频$L(\omega)$唯一确定相频$\varphi(\omega)$
- 从而才能确定开环$G(s)$
- **只有单位负反馈**才能够仅由开环 $G(s)$ 唯一确定 闭环 $\Phi(s)$
- 从而才能够确定调节时间和超调量

因此，**频域法的串联矫正**也是只适用于**单位反馈最小相位系统**.

通过开环传递函数获得**闭环的性能**

1. 低频段：开环增益和系统型别 ⇒ 稳态性能
2. 中频段：$\omega_c, \gamma$ ⇒ 系统稳定性 (**最小相角系统相角裕量大于零就稳定**) 和动态性能 ($\omega_c, \gamma\rightarrow\sigma\%,t_s$)
3. 高频段：抗高频干扰能力
    1. 干扰也有低频的，这里只是说抗高频
    2. 高频段低，直接得出**开环抗高频**干扰，进一步由于$\Phi=\frac G{1+G} \xrightarrow{G\ll 1} G$, 得出**闭环系统**同样抗高频干扰能力强.

> 由于我们想让中频段斜率是 -20dB/dec, 可以反推低频段斜率为 -40dB/dec （从低频段到中频段有一个微分的转折）（如果低频段也是 -20dB/dec, 就说明没有转折，全靠一个积分环节撑到截止频率了）

## 6 系统闭环频率特性分析

系统闭环频率特性的绘制：
实际上，现在闭环频率特性很容易直接测出来，电脑描点作图.
有一种向量法，从开环传函画奈氏曲线，再画出闭环奈氏曲线（尼科尔斯图线）（非重点，感觉意义不大）

闭环频率特性性能指标：
![](assets/%E7%AC%AC05%E7%AB%A0%20%E7%BA%BF%E6%80%A7%E7%B3%BB%E7%BB%9F%E7%9A%84%E9%A2%91%E5%9F%9F%E5%88%86%E6%9E%90%E6%B3%95/2022-03-09-18-41-16.png)

> 注意对比
> 开环截止频率处，开环增益为 0dB
> 闭环带宽频率处，闭环增益为-3dB

## 7 上课笔记

---
**EXAM NOTIFICATION**
矫正涉及频率法
Nyquist 图，对数 Bode 图

对数折线图与传递函数互相转化：

- 通过传递函数画对数折线图
- 通过折线图求传递函数时（先列出大致结构，占分的）。

近似求开环截止角频率$\omega_c$, 对应模为 1
`10 分大题` **奈氏判据**
（半包围法，全包围法都可以，别忘了补充积分环节...)

- 画 Nequist 曲线
- 找起始点，终止点（最好写一下$\angle G(0),\angle G(j\infty)$, 方便找分呐）
- 求相角裕量和幅值裕量
- 求相对稳定性

（注意一下做题步骤）

开环频率特性研究闭环系统性能，`填空选择题`（大的公式不考）
低频段，中频段，高频段的作用.
影响作用最大的是中频段，既决定了稳定性又决定了调节时间.

有空的话，做下这道题
![](assets/%E7%AC%AC05%E7%AB%A0%20%E7%BA%BF%E6%80%A7%E7%B3%BB%E7%BB%9F%E7%9A%84%E9%A2%91%E5%9F%9F%E5%88%86%E6%9E%90%E6%B3%95/2021-01-21-09-30-14.png)

---

之前的时域分析，输入信号是基本信号（阶跃信号等）.
频域分析，输入信号是不同频率的正弦信号.
采用传递函数类型为时间常数式/归一式，因为可以直观看到$\omega\to 0$后的结果.

> `tg^{-1}=arctan\\ tg=tan`
> 波特 Bode
> 奈奎斯特 Nequist

---
传递函数$G(s)$直接把$s$替换成$j\omega$就是频率特性$G(j\omega)$
（如果不采用这种方式，就得列写微分方程然后得到频率特性，很麻烦）
具体证明可以见清华版教材，回来有兴趣可以补上.

---
$G(j\omega)$倒数记为$\hat{G}(j\omega)$

---
一个非常非常重要的结论：
$G(s)\to KG(s)$幅频特性受影响（上下移动$20lg(K)$), 相频特性不受影响.
画 Nequist 图时，K 变化图形形状不变，大小等比例扩大，因此可以推断出某一个点变化后的位置.
画波特图时，K 变化，幅频特性上下平移，相频特性不变.

---
Nequist 曲线

描点作图。取一些特殊点.
$\omega=0,\infty$
与实轴交点（可以使用相角，也可以使用虚部为零得到）, 与虚轴交点（可以使用实部为零得到）

$\omega=0$时的相角需要进行修正，位于分子的环节提供正相角，位于分母的环节提供负相角，谁离原点进谁主导.

---
波特图画法总结：

**一个华点：** 波特图横坐标为$\mu$, 横坐标从 0 开始，意味着$\mu=0,\omega=1$, 因此波特图实际上是$\omega$从 1 开始！
截距就是 K 值：积分环节幅值为 1, 其他环节也忽略掉了！

`1B=20dB`
开环截止角频率$\omega_c$: $L(\omega)$与$\mu$轴的交点.

振荡环节的近似：
$\omega_n=1/T$
$\omega<1/T,L(\omega)=0$
$\omega>1/T,L(\omega)=-40lg\omega$
两个修正：（二阶微分也有类似近似）
$\omega=\omega_r,A=\frac{1}{2\xi\sqrt{1-\xi^2}}$
$\omega=\omega_n,A=\frac{1}{2\xi}$

> $\omega_r=\omega_n\sqrt{1-2\xi^2}$  振荡环节最大幅值处频率
> $\omega_d=\omega_n\sqrt{1-\xi^2}$  振荡环节有阻尼震荡角频率

复杂频率特性图：
标出所有的转折点，遇到转折点改变斜率.

---
由波特图画 Nequist 曲线：
波特图确定特殊点（转折点，起始终止点，与坐标轴的交点$\theta=0,90,180,270$)
Nequist 图描点连线.
**MyOpinion:** 一个总结出来的小技巧，描点连线中间线的变化趋势与圆相近，不要下意识近似直线地相连. 比如说两点角度是$-90-+90$, 那么连线的斜率变化就像单位圆$-90-+90$.

---
由$L(\omega)$求$G(s)$ **考试必考**

从图上的转折点以及斜率变化确定$G(s)$的基本形式（有几个什么环节）, 然后可以先用$\omega_1,\omega_2,...$列出$G(s)$
（注意，当斜率变化 40dB 时，如果没有修正，当做两个一阶，有修正，为二阶震荡/微分）**列式子占一半分**
根据图上标出的点求对应的$\omega$, 一个很好的技巧是，列几何关系（有时候会需要延长线）,$(\lg\omega-\lg x)*20=h$

---
Nequist 稳定判据 **考试必考**

- 需要根据开环传递函数画出$L(\omega),\theta(\omega)$大致曲线（注意这里不需要精确求每个点的具体数值，只需要能够得到 Nequist 曲线的大致形状就可以了）
- 画 Nequist 曲线
    - 遇到虚轴存在开环极点时，需要绕过去，使用广义 Nequist 稳定判据. 往左往右绕都可以，往左绕的话，绕过的那个极点就被算在右半平面，往右绕，绕过的那个极点就被算在左半平面.
- 在画出大致形状正确的 Nequist 曲线（相频特性不出错）后，看一看关键点即满足$\theta(\omega)=0$的$\omega$所对应的 A, 也就是找 Nequist 曲线与实轴交点.
    - 需要注意$tg^{-1}(k\omega)$是角度，在列出幅角满足的关系式后，可以两边取 tan 试一试求.![](assets/%E7%AC%AC05%E7%AB%A0%20%E7%BA%BF%E6%80%A7%E7%B3%BB%E7%BB%9F%E7%9A%84%E9%A2%91%E5%9F%9F%E5%88%86%E6%9E%90%E6%B3%95/2020-11-22-18-53-05.png)
- 因为需要判断 Nequist 曲线绕-1 点转的圈数，所以上一步就很重要，看-1 在圈里面还是圈外面.
- 理论依据是，K 变化不影响相频特性，相同相角对应相同$\omega$,K 变化图形等比例变化.

---
总结：$\theta(\omega_x)=180^\circ,A(\omega_c)=1$

**相角穿越频率**$\omega_x$
开环频率特性的相角为-180°时对应的角频率。
$\theta(\omega_x)=-180^\circ$
对应波特图$\theta(\omega)$图像中$(2k+1)\pi$线的交点
对应 Nequist 曲线中与负实轴的交点.

1. $\theta=\sum tg^{-1}$
2. $G_0(j\omega)=X+jY$令 Y=0

**开环截止角频率**$\omega_c$（似乎又叫幅值穿越频率）
开环频率特性的模为 1 时对应的角频率。
$L(\omega_c)=0,A(\omega_c)=1$
对应波特图$L(\omega)$中与横轴的交点.（使用对数折线图可以近似求解）
对应 Nequist 曲线中与单位圆的交点.

阶数不太高时，$|G(j\omega)|=1$, 解 s 的 n 次方程
如果阶数到达 3 阶或以上，可通过 Bode 图求近似$\omega_c$（几何关系$\Delta h=k\Delta \mu$)
> 如果参数 K 不确定，则$\omega_c$所在区间并不确定，所以需要分情况讨论. 然后求出来后需要判断结果是否在这个区间里面，进行排除之类的.

**ATTENTION:** 上面这两个量不一定总是能求到，例如$\omega_x$处与负实轴相交，但实际上 Nequist 曲线可能并不交负实轴，此时可以画图，如果趋向无穷时趋向 0 点，则可以认为$\omega_x=\infty$,$h=\infty$.
所以还是先画图 Nyquist, 再求.

---
稳定裕量

- 幅值裕量（相角 180 时）:$h=\frac{1}{|G_0(j\omega_x)|}$
  > 单位时 dB 时，幅值裕度$hdB=-20lg|G(j\omega_x)|$
- 相角裕量（幅值 1 时）:$\gamma=180^\circ+\theta(\omega_c)$

这两个量在 Nequist 曲线上的体现
这两个量在 Bode 图上的体现
理解就好了。

判断稳定裕量前需要确定系统稳定，不然这两个量没有意义. 也无法根据这两个量判断稳定性。（不过 PPT 上说当 P=0 时可以判断稳定性）

**题型拓展：**
如果**相角裕量**为 20, 求此时的 k（或者其他的参数）:$\gamma=180+\angle\theta(\omega_c)=20$
> 理论上有两种方法
> 第一种$|G(j\omega_c)|=1$**求出$\omega_c$**, 然后代入$\gamma=180+\angle\theta(\omega_c)=20$解关于 k 的方程.
> 第二种先求$\gamma=180+\angle\theta(\omega_c)=20$**解出$\omega_c$**, 之后代入模的公式求出 k $|G(j\omega)|_{\omega=\omega_c}=1$
> 不过第二种方法应该是更简单一些，因为一些积分环节是恒定角度，这样解方程阶次低一些.

求**临界稳定**的时候的 K:Nequist 曲线过-1 点，只需要$A(\omega_x)=0$or$\theta(\omega_c)=180$

---
结构稳定：无论当前参数如何改变，系统永远稳定
结构不稳定：无论当前参数如何改变，系统永远不稳定
![](assets/%E7%AC%AC05%E7%AB%A0%20%E7%BA%BF%E6%80%A7%E7%B3%BB%E7%BB%9F%E7%9A%84%E9%A2%91%E5%9F%9F%E5%88%86%E6%9E%90%E6%B3%95/2020-12-01-15-51-32.png)

---
开环频率特性研究闭环系统性能
**考试出填空理解题目**, 比如说对动态性能影响最重要的是中频段，低中高频段各影响什么，高频段反映抗干扰能力，低频段影响稳态误差.

稳定性：Bode 图/Nequist 判据
稳态误差：稳态误差与开环增益有关 ($\frac{1}{1+K} or \frac{1}{K}$), 从 Bode 图低频段可以求出 K, 从而获得稳态误差（低频段影响响应收尾阶段）

- 低频段：积分环节越多，K 越大，稳态误差越小（稳态性能越好）
- 中频段：斜率应该是-20dB(`选择题`) 相角裕量越小，超调量越大，稳定性越差，动态性能越差.
- 高频段

影响作用最大的是：中频段. 既决定了稳定性又决定了调解时间.
![](assets/%E7%AC%AC05%E7%AB%A0%20%E7%BA%BF%E6%80%A7%E7%B3%BB%E7%BB%9F%E7%9A%84%E9%A2%91%E5%9F%9F%E5%88%86%E6%9E%90%E6%B3%95/2021-01-21-10-31-46.png)

![](assets/%E7%AC%AC05%E7%AB%A0%20%E7%BA%BF%E6%80%A7%E7%B3%BB%E7%BB%9F%E7%9A%84%E9%A2%91%E5%9F%9F%E5%88%86%E6%9E%90%E6%B3%95/2021-01-21-10-23-42.png)

![](assets/%E7%AC%AC05%E7%AB%A0%20%E7%BA%BF%E6%80%A7%E7%B3%BB%E7%BB%9F%E7%9A%84%E9%A2%91%E5%9F%9F%E5%88%86%E6%9E%90%E6%B3%95/2021-01-21-11-49-03.png)

---
Nequist 曲线中可以读取到的信息：
稳定性：绕-1 的圈数
起点：从常数开始（没有微积分环节）, 从无穷远点开始（有积分环节）, 从零点开始（有微分环节）（注意，仅根据曲线完全可以判断出有没有积分环节有几个积分环节）
> V: 积分数
> P: 微分数

---
关于使用等效开环传函求 Nequist 判据

为什么可以？...TO BE CONTINUED

---
最小相角系统
对于闭环系统，如果它的**开环传递函数**极点和零点的实部**都小于或等于零**，则称它是最小相位系统，如果开环传递函数中有正实部的零点或极点，或有延迟环节，则称系统是非最小相位系统。因为延迟环可以用零点和极点的形式近似。

---
运算技巧总结

复数取模运算
复数求相角运算（求$z=x+yj$相角时$\arctan\frac{y}{x}$, 注意进行一定的转换，因为$\arctan$是锐角）

复数分子有理化（一般分子阶数更低，因此分子有理化更加方便）, 求$\omega_x$

$\tan90^\circ=\infty$
$\frac{\infty+0.5\omega}{1-\infty 0.5\omega}=\frac{1+\frac{0.5\omega}{\infty}}{\frac{1}{\infty}-0.5\omega}=\frac{1}{-0.5\omega}$

在实际计算时，可以采取各种近似方法，只要最终结果与答案接近就可以.（不用局限于 PPT 上讲过的）高阶系统允许存在误差.

例如在求相角裕度时，
使用波特图折线图近似求解$\omega_c$
然后代入$\gamma=180+\angle G(j\omega_c)$
在求$\angle G(j\omega_c)$时，可以和折线图一样忽略掉$\omega_c$右边的环节，因为折线图中这个环节转折点之前都认为这个环节可以忽略.
如果列完式子之后$\omega$阶次还是三次及以上没法求，可以将$\omega_c$离得远的环节给固定成 90 度相角之类的（例如$jT\omega+1$中，$T\omega\gg1$,10 倍差距就可以忽略掉实部了）

---
![](assets/%E7%AC%AC05%E7%AB%A0%20%E7%BA%BF%E6%80%A7%E7%B3%BB%E7%BB%9F%E7%9A%84%E9%A2%91%E5%9F%9F%E5%88%86%E6%9E%90%E6%B3%95/2020-12-01-23-01-31.png)

---
开环幅频特性 A
闭环幅频特性 M

---
频域性能指标与时域性能指标的关系

- 时域分析：闭环传递函数，二阶系统（高阶通过选取主导极点，简化为二阶）
- 频域分析：开环传递函数，高阶系统

(**考试不考调节时间等的公式，但是考研会考**)

$G(s)\to\omega_c\to\gamma(35^\circ-90^\circ)\to t_s,\sigma$
$t_s,\sigma$有对应的近似公式，但是如果$\gamma$脱离了上面的范围，近似公式的误差就会很大.

---
闭环传函通常没有积分环节

$G(s)=\frac{Ka}{s^{\gamma}b}$
$\phi(s)=\frac{Ka}{s^{\gamma}b+Ka}$
通常开环传函分母阶数更高，这意味着 K 不会是一个 s 的系数，因为 s 可以被提走.

$\omega_c\uparrow$频域宽，更容易再现信号$t_s\downarrow$

---
做题小总结：

**ATTENTION:** 题目给的是开环还是闭环！
P227 5-4

存在延时环节的题目$e^{-\tau s}$只改变相位不改变幅值.
$G_0(s)=\frac{2e^{-\tau s}}{s+1}$

- 如果$\tau=1,\gamma=?$
- $\phi(s)$稳定时，求$\tau$的范围
- $G_0(s)=\frac{Ke^{-\tau s}}{s+1}$ 求 K 的稳定范围

劳斯判据判断右极点数

---
**考试**不考出射点入射点出射角入射角

---
转折频率的计算

需要注意$\omega$是角频率，但是我们一般在应用层面说频率的时候是指$f(Hz)$,$\omega=2\pi f$可以进行转化.
