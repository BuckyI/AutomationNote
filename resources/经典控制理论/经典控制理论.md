---
title: 经典控制理论
date: 2022-02-06 20:59:50
tags:
---

# 经典控制理论
<!-- markdownlint-disable-file MD025 -->
<!-- markdownlint-disable-file MD033 -->
[toc]

> 遇到想要记忆的知识点暂时补充进来，回来整理合并到原始笔记中！!! （编辑原始笔记比较费时
> 来自考研期间 Notion 上做的笔记

TODO: 课本 190 有很多曲线名字
TODO: 视频：自动控制原理（经典控制）[DR_CAN 的个人空间_哔哩哔哩_bilibili](https://space.bilibili.com/230105574/channel/seriesdetail?sid=1569593)

- 稳：稳定性
    - 时域法：极点位置，劳斯判据
    - 复域法（根轨迹法）：画出根轨迹，极点位置一目了然
    - 频域法：Nyquist 判据 （对于最小相位系统判断$\gamma$也可以）（判据有不同形式，本质相同）
- 准：$e_{ss}$ 时域的静态误差系数法
- 快：以 $t_s,\sigma\%$ 为代表的性能指标

    时域和频域的性能指标可以互相转化，典型系统使用时域法方便，高阶系统使用频域法方便。

    - 时域法：$\xi,\omega_n$
        - 典型系统：**时域公式**
        - 高阶系统：
            - 主导极点法：**忽略极点简化系统结构**
            - 零点极点法：忽略之后如果还不是典型系统时使用
    - 复域法（根轨迹法）：借助时域工具（因为极点位置读图已知
    - 频域法：$\gamma, h$
    $\gamma\leftrightarrow\sigma\% ;\quad \gamma,\omega_c\leftrightarrow t_s$
    （包括开环和闭环）

        - 典型系统
        - 高阶系统：**经验估计公式 [胡寿松 P218]**
            - $\sigma=0.16+0.4(M_r-1)$
            - $t_s=\frac\pi {\omega_c}(2+1.5(M_r-1)+2.5(M_r-1)^2)$
            - $M_r=M(\omega_r)\approx\frac{1}{\sin\gamma}$
- 矫正动态性能
    - 时域法矫正（根轨迹矫正）主要根据 $\xi,\omega_n$计算 $t_s,\sigma\%$
    - 频域法矫正主要根据 $\gamma\leftrightarrow\sigma\% ;\quad \gamma,\omega_c\leftrightarrow t_s$ 计算  $t_s,\sigma\%$

**减小或消除系统稳态误差：**

系统稳态误差实际上就是说，输出量和期望输出量之间有一定的差距。可以这样理解，系统是按照偏差控制，如果偏差没了，输出也就没了。

1. 提高开环增益：偏差不会消除，但是维持相同的输出需要维持更小的偏差
2. 提升系统型别：从内部来说，增加积分环节，这样不需要维持偏差，积分环节也能够稳定输出一个控制信号。
3. 使用复合控制：直接在控制环以外再加一个回路，这样输入、扰动自身作为控制信号抵消自身。

---

- 求 $\omega_x$ : $G(j\omega)=X+jY\rightarrow Y=0 \rightarrow \omega\rightarrow X$
- 求根轨迹与虚轴交点 : $D(j\omega)=X+jY\rightarrow X=Y=0 \rightarrow \omega,K$

## 1 第一章 自动控制的一般概念

![](assets/经典控制理论/Untitled.png)

### 1.1 最小相位系统

之前的笔记做了一部分，现在结合卢京潮老师提到的记录一下

非最小相位系统（nonminimum phase systems），若控制系统有位于 s 右半开平面上的极点或零点，则称它为非最小相位系统。

增加延时环节也会产生非最小相位系统

$$
e^{-\tau s}\approx \frac{\frac 2\tau-s}{\frac 2\tau+s}
$$

右半平面零极点对应不稳定环节 , 如 $\tau s-1$。

非最小相角系统 ⇒ 一定是条件稳定 （根据根轨迹，从开环极点到开环零点，一定存在 K, 使根到达右半平面）. 换个角度，并非最小相位系统就一定不稳定，只是更难控制了而已，从根轨迹去理解.

最小相角系统由 $L(\omega)$ 可以唯一确定 $\varphi(\omega)$

对于最小相角系统，相角裕量$\gamma>0$时，系统一定稳定（$h>1$）。[课本上的表述：至多仅存在一个 $\omega_x,\omega_c$ , 且开环传递函数无 s 右半平面极点时，$\gamma>0,h>1$ ⇒ 稳定]

1. 非最小相位系统在初始阶段有与我们想要的稳态跟踪值反向的输出，我们姑且称之为 **「一个 “欲扬先抑” 的行为」** 。

    ![](https://pic4.zhimg.com/v2-3a7788c9f1cf001de3a45425c58eedf3_r.jpg)

2. **在具有相同幅值特性的系统中，最小相位系统的相角变化范围是最小的.** 非最小相位系统**相位变化最少**

    在正弦信号的作用下，具有相同幅频特性的系统（或环节），最小相位系统的相位移最小，而非最小相位系统的相位移大于最小相位系统的相位移。

    画相频特性曲线时，**根据经验来说**, 添加一个不稳定环节，更可能使相频特性曲线刚开始有一个反向变化的过程.

    从$G$分析，不稳定环节和稳定环节在最终的相位相同，只是开始不一样. $\tau s+1: 0\to\frac\pi2$, 而 $\tau s-1: \pi\to\frac\pi2$

> [最小相位系统与非最小相位系统的区别](https://blog.csdn.net/qq_39554681/article/details/89256995)
>
> 非最小相位情况产生的原因，一是系统包含有非最小相位元件 （带有时滞特性 / 延时，相位滞后），二是系统的内部回路不稳定 （有正根）；
>
> 非最小相位环节对系统造成的影响
> 非最小相位系统响应缓慢 （原因在于，具有相同幅频特性的情况下，非最小相位系统具有更大的相角变化范围，这带来了频域上的相位滞后，表现在时域上即为阶跃响应稳态值相同的情况下，上升时间和调节时间更长）；
>
> 最小相位系统因为相移小，在实际工程应用中表现为同频率输出信号在时间上能够很快的跟踪上输入，说白了就是时延小。这样的系统就比较容易设计控制器，调节效果一般也都不错。
>
> 再来说非最小相位系统，非最小相位系统因为相位差别大，往往会造成输出的信号的时延增大，时域响应由于存在不稳定的零点，甚至会出现反向效应，这样的系统想设计可实现的控制器，就比较困难了。
>

### 1.2 名词汇总

> 频率名词：
>
> 谐振频率 $\omega_r$；带宽频率$\omega_b$ ；截止频率$\omega_c$；阻尼振荡角频率$\omega_d$ ; 穿越频率 $\omega_x$
>

## 2 第二章 控制系统的数学模型

电感 $u=L\frac{di}{dt}$ ⇒ $\frac{U}{I}=sL$

电容 $i=C\frac{du}{dt}$⇒  $\frac{U}{I}=\frac{1}{sC}$

- [ ]  **不清楚阻尼要不要学一下，回来看往年真题里数学建模部分考到什么程度**
- [ ]  根据电路列微分方程
- [ ]  结构图化简
- [ ]  各个概念的名字区分

![](assets/经典控制理论/Untitled%201.png)

[（完整版） 拉氏变换常用公式 - 百度文库](https://wenku.baidu.com/view/a7fc3a52846a561252d380eb6294dd88d1d23dc6.html)
[常用拉氏变换表](https://www.cnblogs.com/yuankai-ren/p/11622815.html)

![](assets/经典控制理论/Untitled%202.png)

传递函数$\Phi(s)$的**增益或者传递系数**, 即放大信号的倍数，假设输入信号是一个常值（阶跃信号$\frac1s$), 根据中值定理，$\lim_{s\to0}s\frac1s\Phi(s)=\lim_{s\to0}\Phi(s)$

因此我们把传递函数里的 s 都置零后得到的**常数**就称为增益. （对于分母有 $s^v$ 的，忽略掉这部分）

开环传递函数的是**开环增益**, 闭环传递函数的是**闭环增益**. 一般我们把传递函数写成尾一式、归一式，那么分子的 K 就是增益值.

另外还有一个概念，专门针对开环传递函数写成首一式时的 K, 称为**根轨迹增益**.

![](assets/经典控制理论/Untitled%203.png)

## 3 第三章 线性系统的时域分析法

- 往左：平稳性
- 往上：快速性

![](assets/经典控制理论/Untitled%204.png)

3 个特殊的阻尼比，可以记一下，挺好记的，30,45,60, 超调差不多都和 4 有关，16, 5, 0.43

| $\xi$ | $\beta$ | $\sigma\%$ |
| --- | --- | --- |
| 0.5 | 60 | 0.43 |
| 0.707 | 45 | 4.33 (5) |
| 0.866 | 30 | 16.3 |

### 3.1 **最佳阻尼比** 0.707

固定$\xi\omega_n=C$ , 即极点实部不变，根据近似计算公式，调节时间不变.

但是实际上，$\xi=0.707$ 处，调节时间 $t_s$ 最小.

![](assets/经典控制理论/Untitled%205.png)

固定 $\omega_n=C$ 也能得出一样的结论.

![](assets/经典控制理论/Untitled%206.png)

总结：

1. 纯从理论研究来看，对于二阶系统来说，阻尼比为 0.707 时，实际调节时间最短，所以说是最佳.
2. 超调 5%, 也不算很大
3. 极点对应位置是 45°线上
4. 我们希望系统**极点位于 45°线上，离虚轴越远越好**

### 3.2 典型二阶系统

- $\omega_n$
- $\omega_d=\omega_n\sqrt{1-\xi^2}$
- $\omega_r=\omega_n\sqrt{1-2\xi^2}$
- $\omega_b=\omega_n\sqrt{1-2\xi^2+\sqrt{2-4\xi^2+4\xi^4}}$ （这个公式可能不需要记吧。)

对于最佳阻尼比 $\xi=0.707$,

- 带宽频率 $\omega_b=\omega_n$
- 谐振频率 $\omega_r=0$
- 谐振峰值 $M_r=1$

阻尼比 $\xi=1$时，刚好没有超调量，典型二阶系统=2 个惯性系统

$s^2+2\omega_n^2 s+\omega_n^2=(s+\omega_n)^2$

### 3.3 高阶系统处理方法

1. 主导极点法 ⇒ 舍去离虚轴远的，偶极子等，计算性能
2. 如果舍去能舍去的东西之后，发现剩余的还是 2 阶以上，就使用零点极点法
    - [ ]  零点极点法估算高阶系统 第三章第十节

### 3.4 增加零极点

| 开环零点 | 从对根轨迹影响去理解，把根轨迹往左弯，并且零点还是根轨迹的终点. |
| --- | --- |
| 开环极点 | 从对根轨迹影响去理解，把根轨迹往右弯，不利于稳定性. |
| 闭环零点 | 从新增串联微分环节去理解，响应变快，超调增大，减小阻尼 |
| 闭环极点 | 从新增串联惯性环节去理解，响应变慢，超调减小，增大阻尼 |

### 3.5 劳斯判据

劳斯表中出现全零行 表示相应方程中含有一些大小相等符号相反的实根或共轭虚根 (**关于虚轴对称的根**)。

利用系数全为零行的上一行系数构造一个辅助多项式，并以这个辅助多项式导数的系数来代替表中系数为全零的行，完成劳斯表的排列。这些大小相等、符号 相反的根可通过求解辅助方程得到，而且其根的数目总是偶数的。

如果发现存在纯虚根，说明**临界稳定**.

### 3.6 静态误差系数法

- 开环增益变大，则误差信号被放大，说明只需要维持很小的误差信号就能够实现较大的控制效果
- 闭环增益变大，只改变整体的幅值，不影响动态性能.

## 4 第四章 线性系统的根轨迹法

根轨迹是根据闭环传函的分母也即特征方程$D(s)=0$画出来的.

所以只要 $D(s)=0$ 相同，闭环传函的极点也就相同. 这就是参数根轨迹中根据 $G^*(s)$ 的依据.

$G^*(s)$ 对应的闭环传递函数与原始的闭环传递函数，极点相同，零点不同. 所以只需要用它画根轨迹，不需要用它分析性质.

画根轨迹前，列出开环传递函数，写出开环增益 K 的表达式，和系统型别。

### 4.1 区分

- 根轨迹增益 $1+K^*G=0$  (G 必须要写成首一式）
    - 首一式即 s 的系数为 1, 比如说 $(-s+1)\to-(s-1)$, 还有$s^n+...$
    - 参数根轨迹下，要把变化的参数化成 根轨迹增益
    - 根轨迹增益从 0 到无穷大，画出根轨迹.
- 开环增益 $G(s)$
    - 闭环系统性能 $e_{ss}=\frac AK$ , 分母是开环增益.

### 4.2 根轨迹性质

- 相角条件：确定根轨迹 $\varphi=180$
- 模值条件：确定参数 K

**对称性：** （与奈式曲线区分）

- 根轨迹：K 0→∞, 180 度根轨迹；K 0→-∞, 0 度根轨迹

  根轨迹关于实轴对称

- 奈式曲线：$\omega=0\to\infty$, 和 $\omega=0\to-\infty$ 关于极轴对称

**根之和**: 闭环系统极点之和等于开环系统极点之和且为常数

**根之积:**

![](assets/经典控制理论/Untitled%207.png)

### 4.3 计算分离点

- 常规的 $\sum  \frac 1d=\sum  \frac 1d$...

  需要注意, 分子是一, 分母是单根(复数根要拆开写), 一边是零点, 一边是极点. 没有零点写0.

- $M'N-N'M=0$ 感觉也挺方便的.

### 4.4 由根轨迹获得闭环传递函数

1. 闭环零点：前向通道零点，反馈通道极点
2. 闭环极点：根轨迹
3. 闭环增益：这个比较 tricky, 如果情况比较复杂就现推吧...

   反正记好特征方程的样子，如果 n>m 的化，特征方程是首一式 $s^n+...$, 这样根据根轨迹读出极点，直接连乘就放到分母就好了.

   如果 n=m, 特征方程 $N+KM\to (1+K)s^n+...$ 所以... （详细可以看 PPT （应该只适用于单位负反馈

总而言之，零极点是比较好看，闭环增益需要小心，没有特别方便的规律. 如果系统结构图已经给出来了，不妨手动去化，不会出错.

## 5 第五章 线性系统的频域分析法

- 幅相特性曲线 $G(j\omega)$  (Nyquist 曲线）
- 相频特性曲线 $L(\omega)$
- 幅频特性曲线 $\varphi(\omega)$

### 5.1 稳定裕度

- 结构稳定
- 条件稳定：参数影响稳定性 ⇒ 需要提出 $\gamma,h$ 衡量相对稳定性
- 结构不稳定

---

- 幅值裕量（相角 180 时）:
    - $h=\frac{1}{|G_0(j\omega_g)|}$
    - 单位时 dB 时，幅值裕度$h(dB)=20lg\frac 1{|G(j\omega_g)|}=-20lg|G(j\omega_g)|$
- 相角裕量（幅值 1 时）: $\gamma=180^\circ+\theta(\omega_c)$

> 注：卢京潮讲的 相角 180 时，对应的是 $\omega_g$, 而当时老师讲的是 $\omega_x$
>

一个性能良好的控制系统，其

- 相位裕度应具有 45° 左右 ($30\sim60$ ) 的数值。
- 幅值裕度 $h>6dB$

**求稳定裕度的思路总结：**

- 相角裕度 $\gamma$ 的基本方法
    - **精确解法**: 根据$|G(j\omega_c)|=1$求解高阶 $\omega$ 方程组 （计算器试根之类的）
    - **近似解法**: 根据波特图 $L(\omega)-\omega$ ，找到幅值特性曲线与水平轴的交点$\omega_c$ 即为截止频率

        求 $\omega_c$ 其实就是涉及到近似的方法（也不能说是近似吧，因为幅频特性曲线本身就是近似的，这样取相同的近似方法，求出的就是近似的幅频特性曲线上的精确的$\omega_c$）

        由于基本单位是 $\frac s\omega+1,\;\frac 1{\omega^2}s^2+2\frac\xi\omega s+1$

        转折频率在 $\omega_c$ 后面的，没有发挥作用，求模的过程中置为 1

        转折频率在 $\omega_c$ 前面的，发挥了作用，求模的过程中置为$\frac s\omega,\;(\frac s\omega)^2$

    - **实际操作解法**:
        - 如果波特图已知，那么可以根据一定的几何关系列式求出截止频率，比如说等距等比，这个技巧性更高一些.
        - 另外，保底的方法是，$\omega_c$ 代入$G(j\omega)$，把没有发挥作用的屏蔽掉，从而得到一个近似的截止频率.
        - 如果题目只给了开环传函，也可以先根据转折频率**画出幅频曲线的大致趋势**，然后依次判断转折频率处模大于 1 还是小于 1，从而**确定截止频率所处区间**
- 幅值裕度 $h$ 的基本方法

    由于相频特性曲线不好画，因此$\omega_g$最好还是代数求解。

    - 根据相角条件，解三角方程 $\theta_1+\theta_2+\theta_3=\cdots$
        - $\arctan A+\arctan B=\arctan [\frac{A+B}{1-AB}]$

            如果不太能理解的话，先把 2 个角度放一边，然后两边取 tan，是一样的

            ![](assets/经典控制理论/Untitled%208.png)

        - 化简之后呢，就是一个$\arctan \varphi(\omega)=\theta$ 一般来说都是 0°或者 90°

            0°说明分子是 0，90°说明分母是 0

    - 整理$G(j\omega)=X+jY$，令$Y=0$ 解出来

### 5.2 波特图 - 幅频特性曲线

零型以上的系统，$\omega\to0$ 时，幅值为无穷大.

在画幅频特性曲线时，并不会出现无穷大得幅值，是因为横坐标是以 $\lg \omega$ 为单位的，等距等比. 所以纵轴不可能放在 $\omega=0$ 处.

一般来说，纵轴起始位置的 $\omega$ 是 0.1, 1, 0.01 这种.

### 5.3 奈式判据

$Z=P-2N$

N 是-1 左侧的穿越次数，不记录穿过 $(-1,j0)$ 的次数，穿过时临界稳定.

### 5.4 Nyquist 曲线的修正

曲线指定了 $\omega=0\to \infty$ （结合后面稳定判据，实际上是 Nyquist 路径的一半。)

1. 虚轴上存在极点
    1. 如果有积分环节 （原点处有极点），则需要绕一个路径，从$0\;(s=\varepsilon+j0)\to 0^+ (s=0+j\varepsilon)$. 反映在 Nyquist 曲线上就是多了一个虚线圆弧. **相角突变减少 90°**
    2. 如果在虚轴上有其他共轭极点，也是同理进行补充。 **相角突变减少 180°**
    3. 总结：对于极点$j\omega$, 取路径$j\omega+\epsilon e^{j\theta}$, 按照逆时针路径（相角增大的方向走）. 因为极点是在分母上作用，所以这段路径使幅值无限大，相角往减小的方向走（逆时针）.

        模都是无穷大，相角有个跳跃.

2. $\omega=0^+$ 时刻，**离虚轴最近的那个零点或者极点**对相角变化产生的影响**最先发挥作用，**故需要使角度进行一定程度的修正，比如 $90^{\circ}\to90^{\circ}-$
3. 存在不稳定环节 $\tau s-1,\frac1{Ts-1}$时， 系统为非最小相位系统，相角变化往往变得更大。分析方法同 2。

    $\omega=0^+$ 时刻，**离虚轴最近的那个零点或者极点**对相角变化产生的影响**占主导地位。**因此相角变化可能会有个折返 ，例如先增大（非线性的$\frac1{Ts-1}$刚开始让相角增大）后减小（总体趋势不可违背）（一般情况下， 普通的相角则是默认单调变化的）

    ![](assets/经典控制理论/Untitled%209.png)

一般我们画奈氏曲线，实际上是概略曲线，认为相角单调减小，相角折返是分析不出来的.

所以，如果需要的话，需要通过 $G(j\omega)$分析一下和对应的轴有没有交点.

### 5.5 三频段理论

三频段理论**分析对象是幅频特性曲线**

适用于**单位反馈的最小相位系统**（只有最小相位系统才能够仅由幅频$L$唯一确定相频$\varphi$以及开环$G$, 只有单位负反馈才能够仅由开环 G 唯一确定 闭环 $\Phi$, 进一步才能够确定调节时间和超调量 )

因此，**频域法的串联矫正**也是只适用于**单位反馈最小相位系统**.

1. 对于非单位负反馈 ⇒ 等效为单位负反馈再矫正

    ![](assets/经典控制理论/Untitled%2010.png)

2. 对于非最小相位系统 ⇒ 只能同时画出 $L(\omega), \varphi(\omega)$, 试探着去矫正

通过开环传递函数获得**闭环的性能**

1. 低频段：开环增益和系统型别 ⇒ 稳态性能
2. 中频段：$\omega_c, \gamma$ ⇒ 系统稳定性 (**最小相角系统相角裕量大于零就稳定**) 和动态性能 ($\omega_c, \gamma\rightarrow\sigma\%,t_s$)
3. 高频段：抗高频干扰能力
    1. 干扰也有低频的，这里只是说抗高频
    2. 虽然高频段低，直接得出开环传递函数抗高频干扰，但是由于$\Phi=\frac G{1+G} \xrightarrow{G\ll 1} G$, 闭环系统同样抗高频干扰能力强.

### 5.6 频域分析的基本观念：**斜率与角度对应**

|斜率|对应相角|
| --- | --- |
| 20dB/dec | 90° |
| 0dB/dec | 0° |
| -20dB/dec | -90° |
| -40dB/dec | -180° |
| -60dB/dec | -270° |

众所周知，传递函数可以拆分成 由 s 和 $\frac s\omega+1$ 作为基本单位组成的，区别只是放在分子还是分母，以及转折频率不同.

- 对于 积分环节和微分环节，提供的相角是稳定不变的
- 而对于$s+\omega$ , 当 s 较大时，相角趋向 90°，也视为稳定不变的，相角的归宿为此.

因此，对于每个特定的斜率，相角都有一个最终的归宿，如果 L 的斜率一直保持在斜率 k , 则相角将**趋向并稳定**在相应的角度 $\frac{k}{20}*90$.

根据 L 的斜率变化，我们可以知道相角的变化趋势，是在何时有向上趋势，何时有向下趋势.

**基于上述理解，可以获得下面的结论：**

- 如果 k 依次是 -20, -40, -60, 对应 -90, -180, -270. 其中最左边最右边都是平的，左右施加影响力相同，那么根据对称性，很容易理解 $\varphi(\omega_g)=180^\circ$ 处于两个转折频率几何中心处.
- 如果幅频特性左右平移，那么相频特性也将同步平移.
- -20 对应-90, 因此我们希望中频带以-20 斜率穿越 0dB 线，并且中频带尽可能宽. （如果中频带无限宽，那么相角裕度将无限趋于 $\gamma=180-90=90$ )
- 从感性角度理解，每个斜率都是一个领域，在这个领域内，相频特性曲线将向着斜率对应的最终归宿去努力.

    只不过领域受左右领域的影响。如果本领域足够宽，那么将屏蔽掉左右的影响.

    滞后超前矫正，我们让滞后部分规定幅值，但是不希望影响相角，那么就让超前部分起作用的点与滞后部分转折频率 $\frac 1{bT}$ 相差 10 倍，这样滞后部分施加的影响就是-6°, 如此就可以安心只考虑超前部分设计了.

## 6 第六章 线性系统的校正方法

- 串联校正
    - 根轨迹矫正
    - 频率特性矫正
- 反馈矫正
- 前馈矫正/顺馈矫正 （课本上前馈似乎指加入前馈滤波）

    使用梅森增益公式求出对应的传递函数，令传递函数为 0, 那么不管"输入"是什么，输出都没有了.

    - 按照输入补偿，令 $\frac CR=0$
    - 按照干扰补偿，令 $\frac CN=0$
- 复合矫正：多种矫正方式有机结合，一般见到的是前馈+串联

### 6.1 根轨迹矫正

这个课本上没找着，当初老师讲的也挺粗略... 我根据卢京潮的课 （十六节课下 28:30 左右）整理了一下大致思路. 实在有需要再研究.

> 下面是超前校正的思路...
>
1. 根轨迹矫正给的是时域指标：$\sigma,t_s\to\xi,\omega_n\to\lambda_{1,2}$

    根据主导极点理论，把系统近似看成二阶系统，则极点位于 $\lambda_{1,2}$ 时刚好满足要求.

2. 根轨迹穿过 $\lambda_{1,2}$, 说明当前系统结构下，存在合适的开环增益使极点位置满足要求，就不需要矫正了.

    根轨迹不穿过  $\lambda_{1,2}$, 就思考一下应该怎么才能让根轨迹穿过它... 比如说  $\lambda$ 代到相角条件中，发现提供的相角比 -180 还低了一些，那就说明要添加个零点再补一点到 -180

    或者通过添加开环零极点对于根轨迹的影响，添加零点根轨迹往左偏，添加极点根轨迹往右偏.

    **实际上这步做题时不需要分析，因为既然需要矫正肯定是需要矫正的.**

3. 确定矫正装置 $G_c=\frac{s-z}{s-p}$

    为了物理可实现，不可能添加纯零点... 另外，既然主要希望零点发挥作用，说明 z 离虚轴近，p 离虚轴远. 另外，这里的 z, p 都设计成**实根**!

    先确定零点 z, 一般放在期望极点的正下方（实际上可以随意放置）

    期望极点处列一下添加校正装置后的，相角条件，可以求出 p

    （任取一个 z, 那么 p 也就由相角条件确定了.)

4. 校正后根轨迹穿过 $\lambda_{1}$, 根据模值条件求出对应的 K

    这时候校正装置其实就是 z,p 以及对应的 K

5. 求出闭环传递函数
    - 闭环传递函数的极点：根轨迹 （由于位于理想极点处，可以使用根之和，根之积求出剩下的根的位置）
    - 闭环传递函数的零点：前向零点和反馈回路的极点
    - K : 详见根轨迹部分的说明，一般 分母阶数高于分子阶数，K 是开环传函的根轨迹增益，也就是前面求的 K

        验算问题：
        （校正后好像不能看成二阶了... 得用零点极点法估算性能？?)

        如果有不足，再调整下，比如说可以不动 控制器，光把 K 减小点试试. 因为根不一定刚好在 $\lambda_{1,2}$处，在它附近慢慢试.

        不过老师讲的 PPT 里，直接忽略了附加零极点对性能的影响 "前面取ζ 时已留有余地，估计会满足要求".

        还有一种思路：**前置滤波组合矫正**

        根轨迹矫正理论上是可以让极点位置刚好就位于你期望他位于的地方，另外虽然有的是高阶系统，但是你选择的理想极点一般能够成为主导极点，其他极点离虚轴很远.

        但是闭环会添加一个零点（开环多一个零点，闭环也会多一个）, 并且放在理想极点正下方的话，离得还挺近的.

        比如说 $\Phi=\frac{K(s+2)}{(s+1-j)(s+1+j)}$, 添加前置滤波矫正 $F(s)=\frac 2{s+2}$, 闭环传递函数就变成了$\Phi=\frac{2K}{(s+1-j)(s+1+j)}$ （增益没有变，只是抵消了零点作用）

        同样的，如果有多余的极点 $\Phi=\frac{K(s+2)}{(s+1-j)(s+1+j)(s+5)}$ , 添加前置滤波矫正 $F(s)=\frac 25\frac {s+5}{s+2}$

### 6.2 频率特性矫正

1. 分析法： $L_0+L_c=L$ 根据$L_0$的问题，选择合适的控制器，调整参数，最终获得符合期望要求的 $L$

    | 矫正类型 | PID 类型 |
    | --- | --- |
    | 超前校正 | PD |
    | 滞后校正 | PI |
    | 滞后超前 | PID |

2. 综合法： $L-L_0=L_c$ 结合 $L_0$, 直接设计一个符合期望要求的 $L$, 幅频曲线相减就是控制器（传递函数相除） （控制器结构不可预期，往往需要简化相减后的$L_c$)

#### 6.2.1 频域串联校正

串联矫正主要是依托于幅频特性曲线的三频段理论，因此只适用于最小相位系统

矫正符号规范： $\gamma, \gamma_0,\gamma^*$ （卢京潮的符号表述）

##### 6.2.1.1 串联矫正方法论

###### 6.2.1.1.1 确定指标

确定指标：实际工程应用中，我们第一确定的应该是闭环指标或者时域指标，需要转化成频域指标，从而依靠频域法进行矫正。

| 闭环指标 | 开环指标 | 时域指标 | 大概含义 |
| --- | --- | --- | --- |
| $M_r=\frac1{\sin\gamma}$ | $\gamma$ | $\xi$ | 相对稳定性 |
| $\omega_r,\omega_b$ | $\omega_c$ | $t_s(\omega_n)$ | 快速性 |

> 区分各个指标对应的是什么情况，互相之间又是相通的。阻尼增大，闭环带宽就减小，系统响应速度减慢。
基本上各种$\omega$之间比较接近，都代表了快速性
>

如果给出时域指标，需要转换成频域指标，并且最后矫正满足频域指标后，再转换成时域指标看是否符合要求。

![](assets/经典控制理论/Untitled%2011.png)

> 频率名词：
>
> 谐振频率 $\omega_r$；带宽频率$\omega_b$ ；截止频率$\omega_c$；阻尼振荡角频率$\omega_d$ ; 穿越频率 $\omega_x$
>
1. 二阶系统：$M_r\rightarrow\xi\rightarrow\gamma(\xi)$
2. 高阶系统：$M_r\approx\frac1{\sin\gamma}\rightarrow \sigma,t_s$

    注意，$M_r$ 是闭环的谐振峰值，可以用开环的 相角裕度近似，适用范围是 $1\le M_r\le1.8$ , 或 $35^{\circ}\le\gamma\le 90^{\circ}$

> 如果 h 作为矫正要求... 主要就是希望高频段（相频-180°处）尽量往下压，这个就是其他一切都设计好之后，验证一下这个，如果不满足调整下参数吧.

###### 6.2.1.1.2 确定系统结构

一般题目会给，另外，稳态误差限定了系统型别以及开环增益，如果要求的系统型别高于现在的，说明需要用 PI(D) 矫正，这里暂不赘述。

###### 6.2.1.1.3 画 L，计算相关系统参数$L\rightarrow\omega_c\rightarrow\gamma_0$

| $\omega_c$ | $\gamma$ | 矫正方式选择 |
| --- | --- | --- |
| 不足 | 不足（注意超前最多弥补 60°, 根据$\varphi_m$ 计算公式判断能否应用） | 超前校正 |
| 不足 | 不足（相角差很多） | PID （提供接近 90°的相角，提高系统型别） |
| 有余 | 不足 （最低$\omega_c^*$处有余） | 滞后矫正 |
| 有余 | 不足 （最低$\omega_c^*$处也不足） | 滞后超前矫正 |

###### 6.2.1.1.4 每种矫正都有自己的思路和过程（虽然大体一致

- 超前校正
    超前校正既影响相角，又影响幅值，并且只有一个参数 a, 满足了相角就确定了 a, 不能再满足幅值，满足了幅值就确定了 a, 不能再满足相角. 因此它的矫正有更多的试凑.

    1. 卢京潮讲的
        1. $\varphi_m=\gamma^*-\gamma(\omega_{c0})+5^\circ\sim10^\circ$  先计算矫正前的相角裕量，估摸着使用超前抬高后，系统本身下降 5-10°, 从而获得超前需要提供的相角. （当然，这个适用于比较温和的系统，如果这个系统截止频率提高一点点，相频下降很多很多，这个估计就是错误的.)
        2. 使用幅频特性找到 $\omega_c^*$ 使$L(\omega_c^*)=10\lg a$
        3. 从而往左往右各走$\sqrt a$ 倍频，就能够得到两个转折频率
    2. 专业课老师当初讲的
        1. 先根据题目要求估摸着指定一个 $\omega_c^*$, 设计 a 满足此处相角，但是幅值管不了，所以实际的$\omega_c''$ 可能偏前或者偏后，最后需要验证.
        2. 现根据题目要求估摸着指定一个 $\omega_c^*$, 设计 a 满足幅值，让校正后精确就是这个截止频率，但是提供的相角管不了，可能不够.

            课本上也是这个思路，可能因为只要有超前，相角就会提供很多，如果发现提供的不够的话，提高 $\varphi$ 就要提高 a, 就试试提高 $\omega_c^*$ , 总之就是不断地试凑.

- 迟后矫正

    迟后矫正主要是利用衰减幅值的特性，衰减相角则根据 $\frac {10}{bT}=0.1\omega_c^*$ 控制在-6°以内，因此很好设计

    1. 确定系统结构 K
    2. 确定用滞后 （经典形式是 -20dB, -40 dB, -60dB, 以 40 dB 甚至 60dB 穿越 0dB 线）
    3. 确定$\omega_c^*$ （首先这里隐含条件是，最低的频率处相角能够满足要求）⇒ $\gamma(\omega)=\gamma^*+6^\circ$

        使用计算器 SOLVE 出对应的 $\omega_c^*$

    4. 确定 b ⇒ 使用滞后的相频特性精准搬移 $\omega_c$ 到 $\omega_c^*$

        $20\lg b+L(\omega_c^*)=0$

    5. 确定 T ⇒ 为了避免负相角的影响 （最高-6°), $\frac{1}{bT}=0.1\omega_c^*$
    6. 验算

- 滞后超前矫正

    结合了 PPT 和卢的方法，总结了一下，就按照这个思路.

    - **基本形式** ⇒ 有缺陷，滞后超前共用一个参数 a , 不精准

        $\frac{T_1s+1}{aT_2s+1}\frac{T_2s+1}{\frac{T_2}{a}s+1}$ (a>1) 先滞后再超前，滞后和超前都是 a 倍频，滞后下拉$20\lg a$, 超前上拉$20\lg a$

    - "改进"形式

        不用关心$G_c$结构是什么，你只需要知道 Bode 图是这个样子的，a≠b , 超前专注于弥补相角，滞后再精确把截止频率放到 A 点.

        ![](assets/经典控制理论/t.svg)

        DE b 倍频，下拉 $20\lg b$ ;

        DC 10 倍频 ;

        CA $\sqrt a$ 倍频，上拉 $10\lg a$

        AB $\sqrt a$ 倍频，上拉 $10\lg a$

        1. 先选择尽可能小的 $\omega_c^*$ , 把系统自身的相角裕量充分挖掘，确定了 A 的横坐标
        2. $\varphi_m=\gamma^*-\gamma(\omega_c^*)+6^\circ$ 确定超前部分要提供的相角，从而 $a=\frac{1+\sin\varphi}{1-\sin\varphi}$ 确定了
        3. 从而 BC 点都确定了（乘$\sqrt a$, 除$\sqrt a$)
        4. 从而 D 点确定了 （除 10)
        5. $20\lg b-10\lg a=L(\omega_c^*)$ 这样才能保证校正后刚好就是 $\omega_c^*$ ⇒ 从而 b 确定了
        6. 从而 E 点确定了 （除 b)
        7. 根据校正装置的各个转折频率直接写出来.
        8. 检验
- PID 矫正

    略，根据滞后超前的矫正思路，应该好设计，毕竟参数只有 3 个.

##### 6.2.1.2 三类矫正的对比

![](assets/经典控制理论/Untitled%2012.png)

超前：财政部拨钱

滞后：动员老百姓拨钱，但是要花费 6° 宣传费

滞后超前：两者都用

- 在条件限定范围内，K 尽量取小，ω尽量取小，才好设计
- 有滞后的矫正都有精确控制截止频率的特性，在验证的时候如果嫌麻烦可以直接用理论上那个截止频率（比如说按照 20 来矫正的，实际上可能是 19.92, 没意义..) 进行验证.

## 7 第九章 线性系统的状态空间分析与综合
